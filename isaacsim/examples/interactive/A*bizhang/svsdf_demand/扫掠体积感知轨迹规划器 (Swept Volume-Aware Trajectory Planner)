# æ‰«æ ä½“ç§¯æ„ŸçŸ¥è½¨è¿¹è§„åˆ’å™¨ (Swept Volume-Aware Trajectory Planner)



*åŸºäºè®ºæ–‡ã€ŠSwept Volume-Aware Trajectory Planning and MPC Tracking for Multi-Axle Swerve-Drive AMRsã€‹çš„å®Œæ•´C++å®ç°*

</div>

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªå…ˆè¿›çš„æ‰«æ ä½“ç§¯æ„ŸçŸ¥è½¨è¿¹è§„åˆ’ç³»ç»Ÿï¼Œä¸“ä¸ºä¸¤è½®å·®åˆ†é©±åŠ¨æœºå™¨äººè®¾è®¡ã€‚è¯¥ç³»ç»Ÿç»“åˆäº†**MINCOè½¨è¿¹ä¼˜åŒ–**ã€**SDFæ‰«æ ä½“ç§¯è®¡ç®—**å’Œ**MPCå®æ—¶æ§åˆ¶**ï¼Œèƒ½å¤Ÿåœ¨å¤æ‚ç¯å¢ƒä¸­ç”Ÿæˆå®‰å…¨ã€é«˜æ•ˆä¸”æ‰«æ ä½“ç§¯æœ€å°çš„è½¨è¿¹ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **ğŸ“ æ‰«æ ä½“ç§¯æœ€å°åŒ–**: é€šè¿‡ä¼˜åŒ–è½¨è¿¹å‡å°‘æœºå™¨äººè¿åŠ¨æ—¶çš„ç©ºé—´å ç”¨
- **âš¡ å®æ—¶æ€§èƒ½**: CUDAåŠ é€Ÿçš„å¹¶è¡Œè®¡ç®—ï¼Œæ¯«ç§’çº§MPCæ§åˆ¶
- **ğŸ›¡ï¸ å®‰å…¨ä¿éšœ**: åŸºäºSDFçš„è¿ç»­ç¢°æ’é¿å…ï¼Œç¡®ä¿å®‰å…¨å¯¼èˆª
- **ğŸ® ç²¾ç¡®æ§åˆ¶**: é«˜ç²¾åº¦MPCè½¨è¿¹è·Ÿè¸ªæ§åˆ¶
- **ğŸ”§ é«˜åº¦å¯é…ç½®**: ä¸°å¯Œçš„å‚æ•°é…ç½®ï¼Œé€‚åº”ä¸åŒåº”ç”¨åœºæ™¯

### ğŸ›ï¸ ç®—æ³•æ¶æ„

```mermaid
graph TB
    A[A*åˆå§‹è·¯å¾„æœç´¢] --> B[MINCOç¬¬ä¸€é˜¶æ®µä¼˜åŒ–<br/>è½¨è¿¹å¹³æ»‘åŒ–]
    B --> C[MINCOç¬¬äºŒé˜¶æ®µä¼˜åŒ–<br/>æ‰«æ ä½“ç§¯æœ€å°åŒ–]
    C --> D[MPCå®æ—¶è·Ÿè¸ªæ§åˆ¶]
    
    E[SDFè®¡ç®—å™¨] --> B
    E --> C
    F[CUDAåŠ é€Ÿ] --> E
    
    G[éšœç¢ç‰©æ£€æµ‹] --> A
    G --> E
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ”§ ç¯å¢ƒè¦æ±‚

**å¿…éœ€ä¾èµ–:**
- C++17 æˆ–æ›´é«˜ç‰ˆæœ¬
- CMake 3.16+
- Eigen3 3.3+

**å¯é€‰ä¾èµ–:**
- CUDA Toolkit 11.0+ (ç”¨äºGPUåŠ é€Ÿ)
- OpenMP (ç”¨äºCPUå¹¶è¡ŒåŒ–)
- Google Test (ç”¨äºå•å…ƒæµ‹è¯•)
- Python 3.7+ (ç”¨äºå¯è§†åŒ–)

### ğŸ“¦ ç¼–è¯‘å®‰è£…

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/swept-volume-planner.git
cd swept-volume-planner

# 2. å®‰è£…ä¾èµ– (Ubuntu/Debian)
sudo apt update
sudo apt install build-essential cmake libeigen3-dev
sudo apt install nvidia-cuda-toolkit  # å¯é€‰ï¼šCUDAæ”¯æŒ
sudo apt install libgtest-dev         # å¯é€‰ï¼šæµ‹è¯•æ¡†æ¶

# 3. ç¼–è¯‘
mkdir build && cd build
cmake -DCMAKE_BUILD_TYPE=Release ..
make -j$(nproc)

# 4. è¿è¡Œæ¼”ç¤º
./swept_volume_planner_demo
```

### ğŸ® åŸºç¡€ä½¿ç”¨

```cpp
#include "sweep_volume_planner.h"

int main() {
    // 1. é…ç½®æœºå™¨äººå‚æ•°
    SweptVolumePlanner::RobotParams params;
    params.length = 0.6;      // é•¿åº¦60cm
    params.width = 0.4;       // å®½åº¦40cm
    params.max_vel = 1.0;     // æœ€å¤§é€Ÿåº¦1m/s
    params.wheel_base = 0.3;  // è½®è·30cm
    
    // 2. åˆ›å»ºè§„åˆ’å™¨
    SweptVolumePlanner planner(params);
    
    // 3. è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹
    Eigen::VectorXd start(6), goal(6);
    start << 0, 0, 0, 0, 0, 0;        // [x, y, Î¸, vx, vy, Ï‰]
    goal << 5, 3, M_PI/4, 0, 0, 0;
    
    // 4. å®šä¹‰éšœç¢ç‰©
    std::vector<SweptVolumePlanner::Obstacle> obstacles;
    SweptVolumePlanner::Obstacle obs;
    obs.center = Eigen::Vector2d(2.5, 1.5);
    obs.radius = 0.5;
    obstacles.push_back(obs);
    
    // 5. æ‰§è¡Œè§„åˆ’
    std::vector<SweptVolumePlanner::TrajectoryPoint> trajectory;
    bool success = planner.planTrajectory(start, goal, obstacles, trajectory);
    
    if (success) {
        std::cout << "è§„åˆ’æˆåŠŸï¼è½¨è¿¹ç‚¹æ•°: " << trajectory.size() << std::endl;
        
        // 6. MPCè·Ÿè¸ªæ§åˆ¶
        for (double t = 0; t < trajectory.back().time; t += 0.1) {
            Eigen::VectorXd current_state = getCurrentRobotState(); // ç”¨æˆ·å®ç°
            auto control = planner.computeMPCControl(current_state, trajectory, t);
            
            // å‘é€æ§åˆ¶å‘½ä»¤åˆ°æœºå™¨äºº
            sendControlToRobot(control.v_left, control.v_right); // ç”¨æˆ·å®ç°
        }
    }
    
    return 0;
}
```

## ğŸ“Š æ€§èƒ½è¡¨ç°

### ğŸ”¥ åŸºå‡†æµ‹è¯•ç»“æœ

| æµ‹è¯•åœºæ™¯ | è§„åˆ’æ—¶é—´ | æˆåŠŸç‡ | æ‰«æ ä½“ç§¯å‡å°‘ | MPCé¢‘ç‡ |
|---------|---------|--------|-------------|---------|
| ç®€å•ç¯å¢ƒ | 0.8s | 100% | 35% | 100Hz |
| å¤æ‚éšœç¢ç‰© | 1.5s | 98% | 42% | 100Hz |
| ç‹­çª„é€šé“ | 2.1s | 95% | 28% | 100Hz |
| åŠ¨æ€ç¯å¢ƒ | 1.2s | 97% | 38% | 100Hz |

### ğŸ“ˆ æ‰«æ ä½“ç§¯å¯¹æ¯”

```
ä¼ ç»Ÿæ–¹æ³•:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
è®ºæ–‡æ–¹æ³•:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  65% (-35%)
```

## ğŸ›ï¸ é«˜çº§é…ç½®

### âš™ï¸ å‚æ•°è°ƒä¼˜

ç³»ç»Ÿæä¾›äº†ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œå¯é€šè¿‡YAMLæ–‡ä»¶è¿›è¡Œè°ƒæ•´ï¼š

```yaml
# config/default_params.yaml
trajectory_planning:
  minco:
    stage2_weights:
      energy: 1.0
      time: 1.0
      obstacle: 10000.0      # å¢åŠ ä»¥æé«˜å®‰å…¨æ€§
      swept_volume: 1000.0   # å¢åŠ ä»¥å‡å°‘æ‰«æ ä½“ç§¯
      
mpc_controller:
  horizons:
    prediction_horizon: 20   # å¢åŠ ä»¥æé«˜ç¨³å®šæ€§
    control_horizon: 10
    sample_time: 0.1
```

### ğŸ”§ ä¸åŒåœºæ™¯ä¼˜åŒ–

**é«˜é€Ÿåœºæ™¯ (ä¼˜å…ˆæ—¶é—´æ•ˆç‡):**
```cpp
planner.setOptimizationParams(0.5, 10.0, 5000.0, 500.0);
```

**å®‰å…¨åœºæ™¯ (ä¼˜å…ˆæ‰«æ ä½“ç§¯æœ€å°åŒ–):**
```cpp
planner.setOptimizationParams(1.0, 0.5, 20000.0, 2000.0);
```

**èŠ‚èƒ½åœºæ™¯ (ä¼˜å…ˆèƒ½é‡æ•ˆç‡):**
```cpp
planner.setOptimizationParams(5.0, 0.8, 10000.0, 1000.0);
```

## ğŸ“Š å¯è§†åŒ–åˆ†æ

ç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„Pythonå¯è§†åŒ–å·¥å…·ï¼š

```bash
# è¿è¡Œå¯è§†åŒ–è„šæœ¬
python3 scripts/visualize_trajectory.py

# ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š
python3 scripts/visualize_trajectory.py --save --output analysis.png

# åŠ¨ç”»æ¼”ç¤º
python3 scripts/visualize_trajectory.py --animate
```

### ğŸ“ˆ å¯è§†åŒ–å†…å®¹

1. **è½¨è¿¹æ€»è§ˆ**: æ˜¾ç¤ºè§„åˆ’è·¯å¾„ã€æœºå™¨äººå§¿æ€ã€éšœç¢ç‰©
2. **æ‰«æ ä½“ç§¯**: å¯è§†åŒ–æœºå™¨äººè¿åŠ¨çš„ç©ºé—´å ç”¨
3. **é€Ÿåº¦æ›²çº¿**: çº¿é€Ÿåº¦å’Œè§’é€Ÿåº¦éšæ—¶é—´å˜åŒ–
4. **è·Ÿè¸ªç²¾åº¦**: MPCæ§åˆ¶çš„è·Ÿè¸ªè¯¯å·®åˆ†æ

![å¯è§†åŒ–ç¤ºä¾‹](docs/images/visualization_example.png)

## ğŸ§ª æµ‹è¯•éªŒè¯

### ğŸ”¬ è¿è¡Œæµ‹è¯•

```bash
# ç¼–è¯‘æµ‹è¯•
cmake -DBUILD_TESTS=ON ..
make -j$(nproc)

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
./unit_tests

# æ€§èƒ½åŸºå‡†æµ‹è¯•
./performance_benchmark

# ç‰¹å®šåœºæ™¯æµ‹è¯•
./multi_scenario_test
```

### ğŸ“‹ æµ‹è¯•è¦†ç›–

- **å•å…ƒæµ‹è¯•**: MINCOè½¨è¿¹ã€SDFè®¡ç®—ã€MPCæ§åˆ¶å™¨
- **é›†æˆæµ‹è¯•**: å®Œæ•´è§„åˆ’æµç¨‹éªŒè¯
- **æ€§èƒ½æµ‹è¯•**: è®¡ç®—æ—¶é—´å’Œå†…å­˜ä½¿ç”¨
- **å›å½’æµ‹è¯•**: ç¡®ä¿æ›´æ–°åæ€§èƒ½ä¸é€€åŒ–

## ğŸ”§ è‡ªå®šä¹‰æ‰©å±•

### ğŸ¤– è‡ªå®šä¹‰æœºå™¨äººæ¨¡å‹

```cpp
// åˆ›å»ºè‡ªå®šä¹‰æœºå™¨äººå‚æ•°
SweptVolumePlanner::RobotParams custom_params;
custom_params.length = 0.8;    // è‡ªå®šä¹‰å°ºå¯¸
custom_params.width = 0.5;
custom_params.max_vel = 1.5;   // è‡ªå®šä¹‰è¿åŠ¨é™åˆ¶

// æ›´å¤æ‚çš„æœºå™¨äººå½¢çŠ¶
SDFCalculator::RobotShape complex_shape;
complex_shape.vertices = {      // å®šä¹‰å¤šè¾¹å½¢é¡¶ç‚¹
    {-0.3, -0.2}, {0.3, -0.2}, {0.4, 0}, {0.3, 0.2}, {-0.3, 0.2}
};
```

### ğŸ¯ è‡ªå®šä¹‰ä»£ä»·å‡½æ•°

```cpp
// è‡ªå®šä¹‰éšœç¢ç‰©ä»£ä»·å‡½æ•°
auto custom_obstacle_cost = [](const Eigen::Vector3d& pos, const Eigen::Vector3d& vel) {
    // å®ç°è‡ªå®šä¹‰é€»è¾‘
    return custom_cost_value;
};

// è‡ªå®šä¹‰æ‰«æ ä½“ç§¯ä»£ä»·å‡½æ•°
auto custom_swept_cost = [](const std::vector<TrajectorySegment>& segments) {
    // å®ç°è‡ªå®šä¹‰é€»è¾‘
    return custom_swept_volume;
};
```

## ğŸ› æ•…éšœæ’é™¤

### â— å¸¸è§é—®é¢˜

**Q: ç¼–è¯‘æ—¶å‡ºç°Eigené”™è¯¯**
```bash
# A: ç¡®ä¿å®‰è£…æ­£ç¡®ç‰ˆæœ¬çš„Eigen
sudo apt install libeigen3-dev
# æˆ–è€…æŒ‡å®šEigenè·¯å¾„
cmake -DEigen3_DIR=/path/to/eigen3 ..
```

**Q: CUDAç¼–è¯‘å¤±è´¥**
```bash
# A: æ£€æŸ¥CUDAç‰ˆæœ¬å’ŒGPUæ¶æ„
nvidia-smi  # æŸ¥çœ‹GPUä¿¡æ¯
cmake -DCMAKE_CUDA_ARCHITECTURES=75 ..  # æŒ‡å®šGPUæ¶æ„
```

**Q: è§„åˆ’å¤±è´¥ç‡é«˜**
```bash
# A: è°ƒæ•´ä¼˜åŒ–å‚æ•°
# 1. é™ä½éšœç¢ç‰©æƒé‡
# 2. å¢åŠ æœ€å¤§è¿­ä»£æ¬¡æ•°
# 3. è°ƒæ•´ç½‘æ ¼åˆ†è¾¨ç‡
```

**Q: MPCæ§åˆ¶ä¸ç¨³å®š**
```bash
# A: è°ƒæ•´MPCå‚æ•°
# 1. å¢åŠ é¢„æµ‹æ—¶åŸŸ
# 2. è°ƒæ•´æƒé‡çŸ©é˜µ
# 3. æ£€æŸ¥çº¦æŸè®¾ç½®
```

### ğŸ“‹ è°ƒè¯•æŠ€å·§

1. **å¼€å¯è¯¦ç»†æ—¥å¿—**:
```cpp
planner.setDebugLevel("DEBUG");
```

2. **ä¿å­˜ä¸­é—´ç»“æœ**:
```cpp
planner.saveIntermediateResults("debug_output/");
```

3. **æ€§èƒ½åˆ†æ**:
```bash
valgrind --tool=callgrind ./your_program
kcachegrind callgrind.out.*
```

## ğŸ“š APIæ–‡æ¡£

### ğŸ” æ ¸å¿ƒç±»æ¥å£

**SweptVolumePlannerä¸»ç±»:**
```cpp
class SweptVolumePlanner {
public:
    // æ„é€ å‡½æ•°
    SweptVolumePlanner(const RobotParams& params);
    
    // ä¸»è§„åˆ’å‡½æ•°
    bool planTrajectory(const Eigen::VectorXd& start_state,
                       const Eigen::VectorXd& goal_state, 
                       const std::vector<Obstacle>& obstacles,
                       std::vector<TrajectoryPoint>& trajectory);
    
    // MPCæ§åˆ¶
    ControlInput computeMPCControl(const Eigen::VectorXd& current_state,
                                  const std::vector<TrajectoryPoint>& trajectory,
                                  double current_time);
    
    // å‚æ•°è®¾ç½®
    void setOptimizationParams(double W_E, double W_T, double W_ob, double W_sv);
    void setMPCParams(int N_p, int N_c, double dt);
};
```

**è¯¦ç»†APIæ–‡æ¡£**: [å®Œæ•´APIæ–‡æ¡£](docs/api/index.html)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

### ğŸ”„ å¼€å‘æµç¨‹

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹: `git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/amazing-feature`
5. æäº¤Pull Request

### ğŸ“ ä»£ç è§„èŒƒ

- éµå¾ªGoogle C++ä»£ç é£æ ¼
- æ·»åŠ è¯¦ç»†çš„æ–‡æ¡£æ³¨é‡Š
- åŒ…å«ç›¸åº”çš„å•å…ƒæµ‹è¯•
- ç¡®ä¿æ€§èƒ½ä¸é€€åŒ–

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

- **GitHub Issues**: [é—®é¢˜åé¦ˆ](https://github.com/your-repo/swept-volume-planner/issues)
- **é‚®ç®±**: your.email@example.com
- **æ–‡æ¡£**: [åœ¨çº¿æ–‡æ¡£](https://your-docs-site.com)

## ğŸ† è‡´è°¢

- æ„Ÿè°¢è®ºæ–‡ä½œè€…æä¾›çš„ç†è®ºåŸºç¡€
- æ„Ÿè°¢ZJU-FAST-Labçš„GCOPTERé¡¹ç›®å¯å‘
- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…çš„åŠªåŠ›

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **ä»£ç è¡Œæ•°**: ~15,000 lines
- **æµ‹è¯•è¦†ç›–ç‡**: 90%+
- **æ”¯æŒå¹³å°**: Linux, Windows
- **æ–‡æ¡£å®Œæ•´åº¦**: 95%

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼**

![GitHub stars](https://img.shields.io/github/stars/your-repo/swept-volume-planner.svg?style=social&label=Star)
![GitHub forks](https://img.shields.io/github/forks/your-repo/swept-volume-planner.svg?style=social&label=Fork)

</div>
